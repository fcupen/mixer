(self.webpackChunkmixer=self.webpackChunkmixer||[]).push([[3063],{3063:(e,t,i)=>{"use strict";i.r(t),i.d(t,{HomePageModule:()=>C});var n=i(8583),s=i(7823),o=i(665),r=i(3686);function c(e,t,i,n){return new(i||(i=Promise))(function(s,o){function r(e){try{l(n.next(e))}catch(t){o(t)}}function c(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,c)}l((n=n.apply(e,t||[])).next())})}var l=i(6215),a=i(8720),u=i(1628);let h=(()=>{class e{constructor(e){this.storage=e,this.mixes=[],this.storage.create()}allMixes(){return this.storage.get("mixes").then(e=>{let t=[];return e&&Array.isArray(e)&&(t=e),t}).then(e=>(this.mixes=e,e))}addMix(e){return this.mixes.push(e),this.storage.set("mixes",this.mixes).then(()=>this.mixes)}removeMix(e){return this.mixes.splice(e,1),this.storage.set("mixes",this.mixes).then(()=>this.mixes)}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(u.K))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),d=(()=>{class e{transform(e){const t=new Date;return t.setHours(0),t.setMinutes(0),0===e&&t.setMilliseconds(0),t.setSeconds(e),t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=a.Yjl({name:"time",type:e,pure:!0}),e})();function m(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"ion-toolbar"),a.TgZ(1,"ion-item"),a.TgZ(2,"ion-label"),a._uU(3,"Nombre del mix"),a.qZA(),a.TgZ(4,"ion-input",8),a.NdJ("ngModelChange",function(t){return a.CHM(e),a.oxw().name=t}),a.qZA(),a.qZA(),a.TgZ(5,"ion-item"),a.TgZ(6,"ion-label"),a._uU(7,"Mix MP3"),a.qZA(),a.TgZ(8,"div",9),a.TgZ(9,"label",10),a._uU(10,"Choose File"),a.qZA(),a.TgZ(11,"input",11),a.NdJ("ngModelChange",function(t){return a.CHM(e),a.oxw().file=t})("change",function(t){return a.CHM(e),a.oxw().handleFileInput(t.target)}),a.qZA(),a.qZA(),a.qZA(),a.TgZ(12,"ion-button",12),a.NdJ("click",function(){return a.CHM(e),a.oxw().addMix()}),a._uU(13," Add "),a._UZ(14,"ion-icon",13),a.qZA(),a.qZA()}if(2&e){const e=a.oxw();a.xp6(4),a.Q6J("ngModel",e.name),a.xp6(7),a.Q6J("ngModel",e.file)}}const x=function(e){return{"mix-click":e}};function p(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"div",14),a.NdJ("click",function(){const t=a.CHM(e).index;return a.oxw().playMix(t,0)}),a.TgZ(1,"div",15),a.TgZ(2,"div",16),a.TgZ(3,"span",15),a._uU(4),a.qZA(),a.TgZ(5,"span",17),a._UZ(6,"ion-icon",18),a.qZA(),a.qZA(),a.TgZ(7,"ion-button",12),a.NdJ("click",function(){const t=a.CHM(e).index;return a.oxw().removeMix(t)}),a._uU(8," Delete "),a._UZ(9,"ion-icon",19),a.qZA(),a.qZA(),a.qZA()}if(2&e){const e=t.$implicit,i=t.index,n=a.oxw();a.Q6J("ngClass",a.VKq(2,x,i===n.indexClick)),a.xp6(4),a.Oqu(e.name)}}function g(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"ion-button",2),a.NdJ("click",function(){return a.CHM(e),a.oxw(2).stopAllMix()}),a._UZ(1,"ion-icon",26),a.qZA()}}function f(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"ion-button",2),a.NdJ("click",function(){return a.CHM(e),a.oxw(2).replayMix()}),a._UZ(1,"ion-icon",27),a.qZA()}}function T(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"ion-footer"),a.TgZ(1,"div",20),a.TgZ(2,"div",21),a._uU(3),a.ALo(4,"titlecase"),a.TgZ(5,"span",22),a._uU(6),a.ALo(7,"date"),a.ALo(8,"time"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(9,"ion-item",23),a.TgZ(10,"ion-label",22),a._uU(11),a.ALo(12,"date"),a.ALo(13,"time"),a.qZA(),a.TgZ(14,"ion-range",24),a.NdJ("click",function(){return a.CHM(e),a.oxw().blurTime(0)})("ionChange",function(t){return a.CHM(e),a.oxw().changeTime(t)})("mousedown",function(t){return a.CHM(e),a.oxw().focusTime(t)}),a.qZA(),a.YNc(15,g,2,0,"ion-button",25),a.YNc(16,f,2,0,"ion-button",25),a.qZA(),a.qZA()}if(2&e){const e=a.oxw();a.xp6(3),a.hij(" ",a.lcZ(4,7,e.mixes[e.prevIndex].name)," "),a.xp6(3),a.hij(" "," ("+a.xi3(7,9,a.lcZ(8,12,e.duration),"HH:mm:ss.SS")+")"," "),a.xp6(5),a.hij(" ",a.xi3(12,14,a.lcZ(13,17,e.currentTime),"HH:mm:ss.SS")," "),a.xp6(3),a.Q6J("max",e.duration)("value",e.currentTime),a.xp6(1),a.Q6J("ngIf",-1!==e.indexClick),a.xp6(1),a.Q6J("ngIf",-1===e.indexClick)}}const Z=[{path:"",component:(()=>{class e{constructor(e,t,i,n,s,o,r){this.mixerProvider=e,this.alertCtrl=t,this.loadingCtrl=i,this.modalCtrl=n,this.router=s,this.routerOutlet=o,this.toastCtrl=r,this.mixes=[],this.prevIndex=-1,this.indexClick=-1,this.name="",this.currentTime$=new l.X(0),this.currentTime=0,this.updateTime=!0,this.showControls=!1,this.duration=-1,this.showAdd=!1,this.currentMix=new Audio}handleFileInput(e){const t=new FileReader;t.readAsDataURL(e.files.item(0)),t.onload=()=>{this.fileBase64=t.result.toString()},t.onerror=e=>{this.presentToast(e).then(()=>{})}}ngOnInit(){this.updateMixer(),this.currentTime$.subscribe(e=>{this.updateTime&&(this.currentTime=e)})}updateMixer(){this.mixerProvider.allMixes().then(e=>{this.mixes=e}).catch(e=>{this.presentToast(e).then(()=>{})})}removeMix(e){this.presentAlert(e).then(e=>{console.log(e)})}addMix(){this.mixerProvider.addMix({name:this.name,data:this.fileBase64,date:(new Date).getTime()}).then(e=>{this.mixes=e,this.name="",this.fileBase64="",this.file=void 0}).catch(e=>{this.presentToast(e).then(()=>{})})}setCurrentTime(){this.currentTime$.next(this.currentMix.currentTime),-1!==this.indexClick&&setTimeout(()=>{this.setCurrentTime()},10)}setDuration(e){this.duration=e}playMix(e,t=this.currentTime){this.stopMix(),e!==this.indexClick?(this.stopMix(),this.prevIndex=e,this.indexClick=e,this.currentMix=new Audio(this.mixes[e].data),this.currentMix.volume=.2,this.currentMix.currentTime=t,this.currentMix.play(),this.currentMix.onplaying=()=>{this.setDuration(this.currentMix.duration),this.setCurrentTime(),this.showControls=!0},this.currentMix.addEventListener("ended",()=>{this.resetAllControls()})):this.resetAllControls()}replayMix(){this.indexClick=-1,this.playMix(this.prevIndex)}stopMix(){this.currentMix.pause(),this.showControls=!1,this.hideControls()}stopAllMix(){this.resetAllControls(),this.stopMix()}resetAllControls(){this.resetSelection(),this.resetCurrentTime(),this.hideControls(),this.currentMix.currentTime=0,this.currentTime$.next(0),this.currentTime=0}hideControls(){this.showControls=!1}resetCurrentTime(){this.currentTime$.next(0)}resetSelection(){this.indexClick=-1}changeTime(e){this.currentTime=e.detail.value}focusTime(e){this.updateTime=!1}blurTime(e){this.currentMix.currentTime=this.currentTime,this.currentTime$.next(this.currentMix.currentTime),this.updateTime=!0}presentToast(e){return c(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:e,duration:2e3})).present()})}presentAlert(e){return c(this,void 0,void 0,function*(){const t=yield this.alertCtrl.create({header:"Delete",subHeader:"",message:"Delete this mix.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:e=>{console.log("Confirm Cancel: blah")}},{text:"Okay",handler:()=>{this.mixerProvider.removeMix(e).then(e=>{this.mixes=e}).catch(e=>{this.presentToast(e).then(()=>{})})}}]});yield t.present();const{role:i}=yield t.onDidDismiss();console.log("onDidDismiss resolved with role",i)})}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(h),a.Y36(s.Br),a.Y36(s.HT),a.Y36(s.IN),a.Y36(r.F0),a.Y36(s.jP),a.Y36(s.yF))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-home"]],decls:12,vars:4,consts:[["translucent","true"],["slot","end"],[3,"click"],["slot","icon-only",3,"name"],[4,"ngIf"],["fullscreen","true"],[1,"flex","w100"],["class","mix",3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[1,"form-group"],["for","file"],["type","file","id","file",3,"ngModel","ngModelChange","change"],["expand","full",3,"click"],["slot","start","name","add"],[1,"mix",3,"ngClass","click"],[1,"w100"],[1,"w100","mix-information"],[1,"play"],["name","musical-notes-outline"],["slot","start","name","trash"],[1,"holder"],[1,"news"],[1,"time"],[1,"flex"],["min","0","step","0.01",1,"w100",3,"max","value","click","ionChange","mousedown"],[3,"click",4,"ngIf"],["name","stop"],["name","refresh-circle"]],template:function(e,t){1&e&&(a.TgZ(0,"ion-header",0),a.TgZ(1,"ion-toolbar"),a.TgZ(2,"ion-title"),a._uU(3,"Mixer"),a.qZA(),a.TgZ(4,"ion-buttons",1),a.TgZ(5,"ion-button",2),a.NdJ("click",function(){return t.showAdd=!t.showAdd}),a._UZ(6,"ion-icon",3),a.qZA(),a.qZA(),a.qZA(),a.YNc(7,m,15,2,"ion-toolbar",4),a.qZA(),a.TgZ(8,"ion-content",5),a.TgZ(9,"div",6),a.YNc(10,p,10,4,"div",7),a.qZA(),a.qZA(),a.YNc(11,T,17,19,"ion-footer",4)),2&e&&(a.xp6(6),a.Q6J("name",t.showAdd?"close":"add"),a.xp6(1),a.Q6J("ngIf",t.showAdd),a.xp6(3),a.Q6J("ngForOf",t.mixes),a.xp6(1),a.Q6J("ngIf",-1!==t.prevIndex))},directives:[s.Gu,s.sr,s.wd,s.Sm,s.YG,s.gu,n.O5,s.W2,n.sg,s.Ie,s.Q$,s.pK,s.j9,o.JJ,o.On,o.Fj,n.mk,s.fr,s.I_,s.QI],pipes:[n.rS,n.uU,d],styles:["#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.holder[_ngcontent-%COMP%]{overflow:hidden}.news[_ngcontent-%COMP%]{animation:slide 7s linear infinite}@keyframes slide{0%{transform:translatex(100%)}to{transform:translatex(0)}}"]}),e})()}];let M=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[r.Bz.forChild(Z)],r.Bz]}),e})(),C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[n.ez,o.u5,s.Pc,M]]}),e})()}}]);