(self.webpackChunkmixer=self.webpackChunkmixer||[]).push([[8562],{8562:(t,e,n)=>{"use strict";n.r(e),n.d(e,{HomePageModule:()=>f});var i=n(8583),o=n(7823),s=n(665),r=n(3686);function c(t,e,n,i){return new(n||(n=Promise))(function(o,s){function r(t){try{a(i.next(t))}catch(e){s(e)}}function c(t){try{a(i.throw(t))}catch(e){s(e)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(r,c)}a((i=i.apply(t,e||[])).next())})}var a=n(8720),l=n(1628);let d=(()=>{class t{constructor(t){this.storage=t,this.mixes=[],this.storage.create()}allMixes(){return this.storage.get("mixes").then(t=>{let e=[];return t&&Array.isArray(t)&&(e=t),e}).then(t=>(this.mixes=t,t))}addMix(t){return this.mixes.push(t),this.storage.set("mixes",this.mixes).then(()=>this.mixes)}removeMix(t){return this.mixes.splice(t,1),this.storage.set("mixes",this.mixes).then(()=>this.mixes)}}return t.\u0275fac=function(e){return new(e||t)(a.LFG(l.K))},t.\u0275prov=a.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function h(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"ion-toolbar"),a.TgZ(1,"ion-item"),a.TgZ(2,"ion-label"),a._uU(3,"Nombre del mix"),a.qZA(),a.TgZ(4,"ion-input",9),a.NdJ("ngModelChange",function(e){return a.CHM(t),a.oxw().name=e}),a.qZA(),a.qZA(),a.TgZ(5,"ion-item"),a.TgZ(6,"ion-label"),a._uU(7,"Mix MP3"),a.qZA(),a.TgZ(8,"div",10),a.TgZ(9,"label",11),a._uU(10,"Choose File"),a.qZA(),a.TgZ(11,"input",12),a.NdJ("ngModelChange",function(e){return a.CHM(t),a.oxw().file=e})("change",function(e){return a.CHM(t),a.oxw().handleFileInput(e.target)}),a.qZA(),a.qZA(),a.qZA(),a.TgZ(12,"ion-button",13),a.NdJ("click",function(){return a.CHM(t),a.oxw().addMix()}),a._uU(13," Add "),a._UZ(14,"ion-icon",14),a.qZA(),a.qZA()}if(2&t){const t=a.oxw();a.xp6(4),a.Q6J("ngModel",t.name),a.xp6(7),a.Q6J("ngModel",t.file)}}const u=function(t){return{"mix-click":t}};function x(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div",15),a.NdJ("click",function(){const e=a.CHM(t).index;return a.oxw().playMix(e)}),a.TgZ(1,"div",16),a.TgZ(2,"div",17),a.TgZ(3,"span",16),a._uU(4),a.qZA(),a.TgZ(5,"span",18),a._UZ(6,"ion-icon",19),a.qZA(),a.qZA(),a.TgZ(7,"ion-button",13),a.NdJ("click",function(){const e=a.CHM(t).index;return a.oxw().removeMix(e)}),a._uU(8," Delete "),a._UZ(9,"ion-icon",20),a.qZA(),a.qZA(),a.qZA()}if(2&t){const t=e.$implicit,n=e.index,i=a.oxw();a.Q6J("ngClass",a.VKq(2,u,n===i.indexClick)),a.xp6(4),a.Oqu(t.name)}}function g(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"ion-button",13),a.NdJ("click",function(){return a.CHM(t),a.oxw().stopMix()}),a._uU(1," Stop "),a._UZ(2,"ion-icon",21),a.qZA()}}const m=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,s,r){this.mixerProvider=t,this.alertCtrl=e,this.loadingCtrl=n,this.modalCtrl=i,this.router=o,this.routerOutlet=s,this.toastCtrl=r,this.mixes=[],this.indexClick=-1,this.name="",this.showAdd=!1,this.currentMix=new Audio}handleFileInput(t){const e=new FileReader;e.readAsDataURL(t.files.item(0)),e.onload=()=>{this.fileBase64=e.result.toString()},e.onerror=t=>{this.presentToast(t).then(()=>{})}}ngOnInit(){this.updateMixer()}updateMixer(){this.mixerProvider.allMixes().then(t=>{this.mixes=t}).catch(t=>{this.presentToast(t).then(()=>{})})}removeMix(t){this.presentAlert(t).then(t=>{console.log(t)})}addMix(){this.mixerProvider.addMix({name:this.name,data:this.fileBase64,date:(new Date).getTime()}).then(t=>{this.mixes=t,this.name="",this.fileBase64="",this.file=void 0}).catch(t=>{this.presentToast(t).then(()=>{})})}playMix(t){t!==this.indexClick?(this.stopMix(),this.indexClick=t,this.currentMix=new Audio(this.mixes[t].data),this.currentMix.play(),this.currentMix.addEventListener("ended",()=>{this.indexClick=-1})):this.stopMix()}stopMix(){this.currentMix.pause(),this.indexClick=-1}presentToast(t){return c(this,void 0,void 0,function*(){(yield this.toastCtrl.create({message:t,duration:2e3})).present()})}presentAlert(t){return c(this,void 0,void 0,function*(){const e=yield this.alertCtrl.create({header:"Delete",subHeader:"",message:"Delete this mix.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:t=>{console.log("Confirm Cancel: blah")}},{text:"Okay",handler:()=>{this.mixerProvider.removeMix(t).then(t=>{this.mixes=t}).catch(t=>{this.presentToast(t).then(()=>{})})}}]});yield e.present();const{role:n}=yield e.onDidDismiss();console.log("onDidDismiss resolved with role",n)})}}return t.\u0275fac=function(e){return new(e||t)(a.Y36(d),a.Y36(o.Br),a.Y36(o.HT),a.Y36(o.IN),a.Y36(r.F0),a.Y36(o.jP),a.Y36(o.yF))},t.\u0275cmp=a.Xpm({type:t,selectors:[["app-home"]],decls:13,vars:4,consts:[["translucent","true"],["slot","end"],[3,"click"],["slot","icon-only",3,"name"],[4,"ngIf"],["fullscreen","true"],[1,"flex","w100"],["class","mix",3,"ngClass","click",4,"ngFor","ngForOf"],["expand","full",3,"click",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"form-group"],["for","file"],["type","file","id","file",3,"ngModel","ngModelChange","change"],["expand","full",3,"click"],["slot","start","name","add"],[1,"mix",3,"ngClass","click"],[1,"w100"],[1,"w100","mix-information"],[1,"play"],["name","musical-notes-outline"],["slot","start","name","trash"],["slot","start","name","stop"]],template:function(t,e){1&t&&(a.TgZ(0,"ion-header",0),a.TgZ(1,"ion-toolbar"),a.TgZ(2,"ion-title"),a._uU(3,"Mixer"),a.qZA(),a.TgZ(4,"ion-buttons",1),a.TgZ(5,"ion-button",2),a.NdJ("click",function(){return e.showAdd=!e.showAdd}),a._UZ(6,"ion-icon",3),a.qZA(),a.qZA(),a.qZA(),a.YNc(7,h,15,2,"ion-toolbar",4),a.qZA(),a.TgZ(8,"ion-content",5),a.TgZ(9,"div",6),a.YNc(10,x,10,4,"div",7),a.qZA(),a.qZA(),a.TgZ(11,"ion-footer"),a.YNc(12,g,3,0,"ion-button",8),a.qZA()),2&t&&(a.xp6(6),a.Q6J("name",e.showAdd?"close":"add"),a.xp6(1),a.Q6J("ngIf",e.showAdd),a.xp6(3),a.Q6J("ngForOf",e.mixes),a.xp6(2),a.Q6J("ngIf",-1!==e.indexClick))},directives:[o.Gu,o.sr,o.wd,o.Sm,o.YG,o.gu,i.O5,o.W2,i.sg,o.fr,o.Ie,o.Q$,o.pK,o.j9,s.JJ,s.On,s.Fj,i.mk],styles:["#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}"]}),t})()}];let p=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[r.Bz.forChild(m)],r.Bz]}),t})(),f=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[[i.ez,s.u5,o.Pc,p]]}),t})()}}]);